---
title: "Proyecto grado Álvaro Montiel"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

## Carga de base de datos de incidencia.

```{r, carga de archivos}
library(readr)
bd <- read_delim("/Users/alvaro/Documents/Data_Science/R/proyecto_grado/cr5_18052022.txt", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
```

## Variables 
TUMOURID: Identificación del tumor.

NOCASO: Número del caso (1 caso puede tener uno o más tumores).

FECNAC: Fecha nacimiento en formato YYYYMMDD (variable numérica).

EDAD: Edad en años a la fecha del diagnóstico.

SEXO: 1=Hombre, 2=Mujeres.

REGCOM: Código comunas: 2101=Antofagasta; 2201=Calama; 2301=Tocopilla.

FECDIAG: Fecha de diagnóstico del tumor en formato YYYYMMDD (variable numérica),
"20030101 - 20151231".

TOP: Código topográfico del tumor en formato CIE-O.

MORF: Código morfológico CIE-O.

COMP: Comportamiento del tumor: 3=Maligno.

GRA: Grado de diferenciación del tumor: 1=Bien diferenciado; 2= Moderadamente Diferenciado;
3=Poco Diferenciado; 4=Anaplásico; 5=Células T; 6=Células B; 7=Célula Nula;
8=Células NK; 9=Desconocido.

EXT: Grado de estensión del tumor: 0=In situ; 1=Localizado; 2=Regional; 
3=Metástasis; 9=Desconocido.

LAT: Lateralidad: 1=Derecha; 2=Izquierda; 3=Bilateral; 4=No Corresponde;
9=Desconocido.

BASE: Base diagnóstico: 0=Solo Certificado de defunción; 1=Clínico; 
2=Investigación clínica;  4=Bioquímica o Inmunología; 5=Citología;
6=Histología de metástasis; 7=Histología de sitio primario; 9=Desconocido.

C10: Código CIE10.

PMSEC: Secuencia de tumores primarios.

PMTOT: Número total de tumores primarios.

FUE1: Fuente.

RUT: Rut del caso.


```{r, Recorte de las variables}
## Carga del paquete dplyr
library(dplyr)

## Nuevos Dataframes; por tipo de tumor, comuna y comportamiento:

## PIEL
bd_piel <- bd %>% 
  filter(TOP==440 | TOP==441 | TOP==442 | TOP==443 | TOP==444 | TOP==445 | 
           TOP==446 | TOP==447 | TOP==448 | TOP==449) %>%
  filter(REGCOM=="02101" | REGCOM=="02201" | REGCOM=="02301" & COMP==3) %>%
  select(TUMOURID, NOCASO, FECNAC, EDAD, SEXO, REGCOM, FECDIAG,
         TOP, MORF, COMP, GRA, EXT, LAT, BASE, C10, PMSEC, PMTOT, FUE1, RUT)

## VEJIGA
bd_vejiga <- bd %>% 
  filter(TOP==670 | TOP==671 | TOP==672 | TOP==673 | TOP==674 | TOP==675 | 
           TOP==676 | TOP==677 | TOP==678 | TOP==679) %>%
  filter(REGCOM=="02101" | REGCOM=="02201" | REGCOM=="02301" & COMP==3) %>%
  select(TUMOURID, NOCASO, FECNAC, EDAD, SEXO, REGCOM, FECDIAG,
         TOP, MORF, COMP, GRA, EXT, LAT, BASE, C10, PMSEC, PMTOT, FUE1, RUT)

## PULMON
bd_pulmon <- bd %>% 
  filter(TOP==340 | TOP==341 | TOP==342 | TOP==343 | TOP==344 | TOP==345 | 
           TOP==346 | TOP==347 | TOP==348 | TOP==349) %>% 
  filter(REGCOM=="02101" | REGCOM=="02201" | REGCOM=="02301" & COMP==3) %>%
  select(TUMOURID, NOCASO, FECNAC, EDAD, SEXO, REGCOM, FECDIAG,
         TOP, MORF, COMP, GRA, EXT, LAT, BASE, C10, PMSEC, PMTOT, FUE1, RUT)
bd_pulmon$TOP_ <- "C34"
```


## Estadística descriptiva
### Univariada categórica, Tráquea, bronquio, pulmón
```{r}
## SEXO
table(bd_pulmon$SEXO)
round(prop.table(table(bd_pulmon$SEXO))*100,2)

## REGIÓN
table(bd_pulmon$REGCOM)
round(prop.table(table(bd_pulmon$REGCOM))*100,2)

## TOPOGRAFÍA
table(bd_pulmon$TOP)
round(prop.table(table(bd_pulmon$TOP))*100,2)

## MORFOLOGÍA
table(bd_pulmon$MORF)
round(prop.table(table(bd_pulmon$MORF))*100,2)

## GRADO DE DIFERENCIACIÓN
table(bd_pulmon$GRA)
round(prop.table(table(bd_pulmon$GRA))*100,2)

## EXTENSIÓN
table(bd_pulmon$EXT)
round(prop.table(table(bd_pulmon$EXT))*100,2)

## LATERALIDAD
table(bd_pulmon$LAT)
round(prop.table(table(bd_pulmon$LAT))*100,2)

## BASE DIAGNÓSTICO
table(bd_pulmon$BASE)
round(prop.table(table(bd_pulmon$BASE))*100,2)

## FUENTE
table(bd_pulmon$FUE1)
round(prop.table(table(bd_pulmon$FUE1))*100,2)

```

```{r}


```







