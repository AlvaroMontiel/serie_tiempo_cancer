plot(data_poblacion_tasa_ajustada_calama,
#ylim=c(0,20),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de pulmón, comuna de Calama",
type="b")
plot(data_poblacion_tasa_ajustada_calama,
ylim=c(0,60),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de pulmón, comuna de Calama",
type="b")
plot(data_poblacion_tasa_ajustada_calama,
ylim=c(0,60),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de piel, comuna de Calama",
type="b")
bd_3 <- subset(bd_, REGCOM=='02301')
table(factor(bd_3$SEXO, levels=c(1,2), labels = c("Hombres", "Mujeres")))
round(prop.table(table(factor(bd_3$SEXO, levels=c(1,2), labels = c("Hombres", "Mujeres"))))*100,2)
morfologia = table(factor(bd_3$MORF_GRUPO,
levels = c(1,2,3),
labels = c("Neoplasias de células escamosas",
"Neoplasias de células basales",
"Otras morfologías")))
morfologia
#table(bd_3$MORF_GRUPO)
round(prop.table(morfologia),3)*100
table(factor(bd_3$GRA, levels = c(1,2,3,4,9), labels =
c("Bien Diferenciado","Moderadamente Diferenciados",
"Poco Diferenciado","Anaplásico","Desconocido")))
#table(bd_3$GRA)
round(prop.table(table(factor(
bd_3$GRA,
levels = c(1,2,3,4,9),
labels =
c("Bien Diferenciado","Moderadamente Diferenciados",
"Poco Diferenciado","Anaplásico","Desconocido")
)))*100,2)
table(factor(bd_3$EXT, levels = c(1,2,3,9), labels = c(
"Localizado","Regional","Metástasis","Desconocido"
)))
#table(bd_3$EXT)
round(prop.table(table(factor(bd_3$EXT, levels = c(1,2,3,9),
labels=c(                                "Localizado","Regional","Metástasis","Desconocido"
)
)))*100,2)
table(factor(bd_3$BASE, levels = c(0,1,6,7),
labels = c("Solo DCO",
"Clínica",
"Histología de MTS",
"Histología de sitio primario")
))
#table(bd_3$BASE)
round(prop.table(table(factor(bd_3$BASE, levels = c(0,1,
6,7),
labels = c(
"Solo DCO",
"Clínica",
"Histología de MTS",
"Histología de sitio primario"
))
))*100,2)
## PRIMARIO MÚLTIPLES
### HAY 134 NA, TRATAR DE ARREGLAR EN LA BASE DE CR5
addmargins(table(bd_3$PMTOT))
bd_3 %>% summarise(
Mínimo = min(EDAD),
Máximo = max(EDAD),
Rango = max(EDAD)-min(EDAD),
Qu_25 = quantile(EDAD, prob=c(0.25)),
Qu_50 = quantile(EDAD, prob=c(0.5)),
Qu_75 = quantile(EDAD, prob=c(0.75)),
Media = round(mean(EDAD),4),
Mediana = median(EDAD),
Varianza = round(var(EDAD),4),
Desv_Estándar = round(sd(EDAD),4),
CV = round(sd(EDAD)/mean(EDAD)*100,4)
)
hist(bd_3$EDAD,
ylab="Frecuencia",
xlab="Edad",
main="Histograma Edad")
plot(density(bd_3$EDAD),
lwd=3,
col="blue3",
xlim = c(15, 100),
main="Gráfico de densidad de la Edad",
las=1,
xlab="Edad",
ylab="densidad")
qqnorm(bd_3$EDAD, pch=20, main="QQ Edad")
qqline(bd_3$EDAD)
# H0 = la muestra proviene de una población normal
shapiro.test(bd_3$EDAD)
sexo_morfologia <- table(factor(bd_3$MORF_GRUPO,
levels=c(1,2,3),
labels = c("Neoplasias de células escamosas",
"Neoplasias de células basales",
"Otras morfologías")),
factor(bd_3$SEXO,
levels = c('1','2'),
labels = c('Hombres', 'Mujeres')))
addmargins(sexo_morfologia)
round(addmargins(prop.table(sexo_morfologia,1),2),4)*100
sexo_extension <- table(factor(bd_3$EXT,
levels=c(1,2,3,9),
labels = c("Localizado",
"Regional",
"Metástasis",
"Desconocido")),
factor(bd_3$SEXO,
levels = c('1','2'),
labels = c('Hombres',
'Mujeres')
))
addmargins(sexo_extension)
round(addmargins(prop.table(sexo_extension,1),2),4)*100
sexo_base <- table(factor(bd_3$BASE,
levels=c(0,1,6,7),
labels = c("Solo DCO",
"Clínico",
"Histología de Metástasis",
"Histología de sitio primario")),
factor(bd_3$SEXO,
levels = c('1','2'),
labels = c('Hombres', 'Mujeres')
))
addmargins(sexo_base)
round(addmargins(prop.table(sexo_base,1),2),4)*100
morfologia_base <- table(factor(bd_3$MORF_GRUPO,
levels=c(1,2,3),
labels = c("Neoplasias de células escamosas",
"Neoplasias de células basales",
"Otras morfologías")),
factor(bd_3$BASE,
levels=c(0,1,6,7),
labels = c("Solo DCO",
"Clínico",
"Histología de Metástasis",
"Histología de sitio primario")))
addmargins(morfologia_base)
round(addmargins(prop.table(morfologia_base,1),2),4)*100
morfologia_extension <- table(factor(bd_3$MORF_GRUPO,
levels=c(1,2,3),
labels = c("Neoplasias de células escamosas",
"Neoplasias de células basales",
"Otras morfologías")),
factor(bd_3$EXT,
levels=c(1,2,3,9),
labels = c("Localizado",
"Regional",
"Metástasis",
"Desconocido")))
addmargins(morfologia_extension)
round(addmargins(prop.table(morfologia_extension,1),2),4)*100
extension_base <- table(
factor(bd_3$EXT,
levels=c(1,2,3,9),
labels = c("Localizado",
"Regional",
"Metástasis",
"Desconocido")),
factor(bd_3$BASE,
levels=c(0,1,6,7),
labels = c("Solo DCO",
"Clínico",
"Histología de Metástasis",
"Histología de sitio primario"))
)
addmargins(extension_base)
round(addmargins(prop.table(extension_base,1),2),4)*100
round(addmargins(prop.table(extension_base,2),1),4)*100
boxplot(bd_3$EDAD ~ factor(bd_3$SEXO,
levels = c(1,2),
labels = c("Hombres", "Mujeres")),
xlab = "Sexo",
ylab = "Edad",
main="Edad por sexo, comuna de Tocopilla")
boxplot(bd_3$EDAD ~ factor(bd_3$MORF_GRUPO,
levels = c(1,2,3),
labels = c("Neoplasia, SAI",
"Carcinomas de cél trans",
"Otras Morf."
)),
xlab="Morfología",
ylab="Edad",
main="Edad por morfología, comuna de Tocopilla"
)
boxplot(bd_3$EDAD ~ factor(bd_3$EXT,
levels = c(1,2,3,9),
labels = c("Localizado",
"Regional",
"Metástasis",
"Desconocido")),
xlab="Extensión",
ylab="Edad",
main="Edad por Extensión, comuna de Tocopilla")
boxplot(bd_3$EDAD ~ factor(bd_3$BASE,
levels = c(0,1,6,7),
labels = c("Solo DCO",
"Clínico",
"MTS",
"Sitio primario")),
xlab="Base Diagnóstica",
ylab="Edad",
main="Edad por Base diagnóstica, comuna de Tocopilla")
### CREAR LA VARIABLE AGE_GROUP
bd_3 <- bd_3 %>% mutate(AGE_GROUP = case_when(
EDAD >= 0 & EDAD <= 4 ~ 1,
EDAD >= 5 & EDAD <= 9 ~ 2,
EDAD >= 10 & EDAD <= 14 ~ 3,
EDAD >= 15 & EDAD <= 19 ~ 4,
EDAD >= 20 & EDAD <= 24 ~ 5,
EDAD >= 25 & EDAD <= 29 ~ 6,
EDAD >= 30 & EDAD <= 34 ~ 7,
EDAD >= 35 & EDAD <= 39 ~ 8,
EDAD >= 40 & EDAD <= 44 ~ 9,
EDAD >= 45 & EDAD <= 49 ~ 10,
EDAD >= 50 & EDAD <= 54 ~ 11,
EDAD >= 55 & EDAD <= 59 ~ 12,
EDAD >= 60 & EDAD <= 64 ~ 13,
EDAD >= 65 & EDAD <= 69 ~ 14,
EDAD >= 70 & EDAD <= 74 ~ 15,
EDAD >= 75 & EDAD <= 79 ~ 16,
EDAD >= 80  ~ 17
))
### CREAR LA VARIABLE YEAR Y MES
library(tidyverse)
year <- ""
mes <- ""
contador <- 1
for(i in bd_3$FECDIAG){
year[[contador]] <- as.integer(str_sub(i, 1, 4))
mes[[contador]] <- as.integer(str_sub(i,5,6))
contador <- contador +  1
}
bd_3$YEAR_DIAG <- as.integer(year)
bd_3$MES_DIAG <- as.integer(mes)
by_age_year <- bd_3 %>% group_by(YEAR_DIAG, AGE_GROUP) %>% count()
### AGREGAR POBLACION ESTANDAR
by_age_year = by_age_year %>% mutate(POB_STANDAR = case_when(
AGE_GROUP == 1 ~ 12000,
AGE_GROUP == 2 ~ 10000,
AGE_GROUP == 3 ~ 9000,
AGE_GROUP == 4 ~ 9000,
AGE_GROUP == 5 ~ 8000,
AGE_GROUP == 6 ~ 8000,
AGE_GROUP == 7 ~ 6000,
AGE_GROUP == 8 ~ 6000,
AGE_GROUP == 9 ~ 6000,
AGE_GROUP == 10 ~ 6000,
AGE_GROUP == 11 ~ 5000,
AGE_GROUP == 12 ~ 4000,
AGE_GROUP == 13 ~ 4000,
AGE_GROUP == 14 ~ 3000,
AGE_GROUP == 15 ~ 2000,
AGE_GROUP == 16 ~ 1000,
AGE_GROUP == 17 ~ 1000
))
### CARGAR POBLACION INE
library(readxl)
if (Sys.info()[['sysname']] == "Darwin"){
#poblacion_ine <- read_delim("/Users/alvaro/Documents/Data_Science/R/proyecto_grado/cr5_18052022.txt",
#delim = "\t", escape_double = FALSE,
#trim_ws = TRUE)
} else {
poblacion_ine <- read_excel("D:/Datasets/poblacion/pob_ine_censo2017_proyecciones.xlsx")
}
### AGE GROUP EN LA POBLACION INE
poblacion_ine <- poblacion_ine %>% mutate(AGE_GROUP = case_when(
Edad >= 0 & Edad <= 4 ~ 1,
Edad >= 5 & Edad <= 9 ~ 2,
Edad >= 10 & Edad <= 14 ~ 3,
Edad >= 15 & Edad <= 19 ~ 4,
Edad >= 20 & Edad <= 24 ~ 5,
Edad >= 25 & Edad <= 29 ~ 6,
Edad >= 30 & Edad <= 34 ~ 7,
Edad >= 35 & Edad <= 39 ~ 8,
Edad >= 40 & Edad <= 44 ~ 9,
Edad >= 45 & Edad <= 49 ~ 10,
Edad >= 50 & Edad <= 54 ~ 11,
Edad >= 55 & Edad <= 59 ~ 12,
Edad >= 60 & Edad <= 64 ~ 13,
Edad >= 65 & Edad <= 69 ~ 14,
Edad >= 70 & Edad <= 74 ~ 15,
Edad >= 75 & Edad <= 79 ~ 16,
Edad >= 80  ~ 17
))
### SUBSET POBLACION ANTOFAGASTA
poblacion_antofagasta <- as.data.frame(subset(poblacion_ine, Comuna == 2301))
### GROUPBY INE ANTOFAGASTA
poblacion_antofagasta_edad <- as.data.frame(poblacion_antofagasta) %>% group_by(AGE_GROUP) %>%
#(`Poblacion 2003`)
summarise(pob_2003 = sum(`Poblacion 2003`),
pob_2004 = sum(`Poblacion 2004`),
pob_2005 = sum(`Poblacion 2005`),
pob_2006 = sum(`Poblacion 2006`),
pob_2007 = sum(`Poblacion 2007`),
pob_2008 = sum(`Poblacion 2008`),
pob_2009 = sum(`Poblacion 2009`),
pob_2010 = sum(`Poblacion 2010`),
pob_2011 = sum(`Poblacion 2011`),
pob_2012 = sum(`Poblacion 2012`),
pob_2013 = sum(`Poblacion 2013`),
pob_2014 = sum(`Poblacion 2014`),
pob_2015 = sum(`Poblacion 2015`),
)
### CREAR UN NUEVO DATAFRAME CON LA POBLACION POR ANO Y GRUPO DE EDAD
posicion = 2
year = 2003
data_poblacion = data.frame()
for (i in colnames(poblacion_antofagasta_edad[2:14])) {
dataframe <- poblacion_antofagasta_edad[posicion]
dataframe$YEAR_DIAG <- year
dataframe$AGE_GROUP <- poblacion_antofagasta_edad$AGE_GROUP
dataframe = rename(dataframe, 'POB' = i)
posicion = posicion + 1
year = year + 1
data_poblacion <- rbind(data_poblacion, dataframe)
}
data_poblacion_tasa <- merge(by_age_year, data_poblacion, by = c('AGE_GROUP', 'YEAR_DIAG'))
data_poblacion_tasa <- data_poblacion_tasa %>% arrange(YEAR_DIAG, AGE_GROUP)
data_poblacion_tasa$EXPECTED_CASES <- data_poblacion_tasa$n * data_poblacion_tasa$POB_STANDAR / data_poblacion_tasa$POB
data_poblacion_tasa_ajustada <- data_poblacion_tasa %>% group_by(YEAR_DIAG) %>% summarise('TASA_AJUSTADA' = sum(EXPECTED_CASES))
data_poblacion_tasa_ajustada_tocopilla <- data_poblacion_tasa_ajustada
data_poblacion_tasa_ajustada_tocopilla
plot(data_poblacion_tasa_ajustada_tocopilla,
#ylim=c(0,50),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de vejiga, comuna de Tocopilla",
col="black",
type="b")
plot(data_poblacion_tasa_ajustada_tocopilla,
ylim=c(20,90),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de vejiga, comuna de Tocopilla",
col="black",
type="b")
plot(data_poblacion_tasa_ajustada_tocopilla,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de vejiga, comuna de Tocopilla",
col="black",
type="b")
plot(data_poblacion_tasa_ajustada_rafta ,
#ylim=c(-10,50),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topright",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(-10,200),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(-10,200),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topright",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
plot(data_poblacion_tasa_ajustada_tocopilla,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Piel, comuna de Tocopilla",
col="black",
type="b")
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(-10,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(-10,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topright",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topright",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Vejiga",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topleft",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
plot(data_poblacion_tasa_ajustada_rafta ,
ylim=c(0,100),
ylab="Tasa incidencia ajustada por 100 mil",
xlab="Años",
main="Tasas de incidencia por cáncer de Piel",
col="black",
type="b",
pch=16)
lines(data_poblacion_tasa_ajustada_cafta$YEAR_DIAG,
data_poblacion_tasa_ajustada_cafta$TASA_AJUSTADA,
type = "b", col="red", pch=15)
lines(data_poblacion_tasa_ajustada_calama$YEAR_DIAG,
data_poblacion_tasa_ajustada_calama$TASA_AJUSTADA,
type = "b", col="blue", pch=10)
lines(data_poblacion_tasa_ajustada_tocopilla$YEAR_DIAG,
data_poblacion_tasa_ajustada_tocopilla$TASA_AJUSTADA,
type = "b", col="green", pch=13)
legend("topleft",
legend = c("R. Afta", "C. Afta", "C. Calama", "C. Tocopilla"),
col = c("black", "red", "blue", "green"),
pch = c(16,15,10,13)
)
